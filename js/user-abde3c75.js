import{M as e}from"./index-cbb612d7.js";import{h as r}from"./axios-fb5b44d7.js";const a=e("userInfo",{state:()=>({username:"",email:"",avatar_url:""}),getters:{},actions:{async login(e){try{const{username:a,email:t,token:s}=await r("/login","POST",{username:e.user,password:e.password});return this.username=a,this.email=t,window.localStorage.setItem("_AUTH_TOKEN",s),Promise.resolve({username:a,email:t,token:s})}catch(a){return Promise.reject(a)}},async resetPass(e){try{const{msg:a}=await r("/resetPass","post",{email:e.email,password:e.password,securityCode:e.securityCode});return Promise.resolve({msg:a})}catch(a){return Promise.reject(a)}},async getSecurityCode(e){try{const{msg:a}=await r("/securityCode","post",{email:e.email,type:e.type});return Promise.resolve({msg:a})}catch(a){return Promise.reject(a)}},async register(e){try{const{msg:a}=await r("/register","post",{username:e.username,email:e.email,password:e.password,securityCode:e.securityCode});return Promise.resolve({msg:a})}catch(a){return Promise.reject(a)}},async getUserInfo(){try{const{username:e,email:a}=await r("/user/info","GET");return this.username=e,this.email=a,Promise.resolve({username:e,email:a})}catch(e){return Promise.reject(e)}},getLastAvatar(){this.avatar_url=window.localStorage.getItem("avatar")||""},async getUserAvatar(){try{const{avatar_url:e}=await r("/avatar","GET");return this.avatar_url=e,window.localStorage.setItem("avatar",e),Promise.resolve({avatar_url:e})}catch(e){return Promise.reject(e)}},async updateUserAvatar(e){try{return await r("/avatar/update","POST",{avatar_file:e.avatar_file}),this.avatar_url=e.avatar_file,window.localStorage.setItem("avatar",e.avatar_file),Promise.resolve({avatar_url:e.avatar_file})}catch(a){return Promise.reject(a)}}}});export{a as u};
