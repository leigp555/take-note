import{_ as e,P as t,e as n,a,f as o,w as l,t as r,c as s,v as i,m as c,C as u}from"./default-add53953.js";/* empty css              */import{d,q as v,r as f,j as p,B as h,s as y,x as m,a as g,c as b,k as w,l as C,_ as k,o as x,e as E,f as O,a6 as S,g as L,S as j,a1 as T,L as N,W as M,X as P,p as B,i as V}from"./index-461f95cc.js";import{t as _}from"./transApi-6a763004.js";import{c as I}from"./canvasImg-0779336a.js";import{T as R}from"./axios-10bb5b34.js";import{g as A,P as X}from"./PortalWrapper-31dadcc5.js";import{K as Y}from"./KeyCode-a2a1cb88.js";import{o as U}from"./omit-4992fbe8.js";import{s as F}from"./Portal-55d80112.js";import{i as W}from"./raf-b2de4fce.js";import{B as z}from"./button-a54e8c4a.js";import"./vnode-89a287a7.js";import"./classCallCheck-5d344be6.js";var H=function(){return{prefixCls:String,width:t.oneOfType([t.string,t.number]),height:t.oneOfType([t.string,t.number]),style:{type:Object,default:void 0},class:String,placement:{type:String},wrapperClassName:String,level:{type:[String,Array]},levelMove:{type:[Number,Function,Array]},duration:String,ease:String,showMask:{type:Boolean,default:void 0},maskClosable:{type:Boolean,default:void 0},maskStyle:{type:Object,default:void 0},afterVisibleChange:Function,keyboard:{type:Boolean,default:void 0},contentWrapperStyle:{type:Object,default:void 0},autofocus:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0}}};var $={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend"},D=$[Object.keys($).filter((function(e){if("undefined"==typeof document)return!1;var t=document.getElementsByTagName("html")[0];return e in(t?t.style:{})}))[0]];function K(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a):e.attachEvent&&e.attachEvent("on".concat(t),n)}function q(e,t,n,a){e.removeEventListener?e.removeEventListener(t,n,a):e.attachEvent&&e.detachEvent("on".concat(t),n)}var Z=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},G=!("undefined"!=typeof window&&window.document&&window.document.createElement),J=function e(t,n,a,o){if(!n||n===document||n instanceof Document)return!1;if(n===t.parentNode)return!0;var l=Math.max(Math.abs(a),Math.abs(o))===Math.abs(o),r=Math.max(Math.abs(a),Math.abs(o))===Math.abs(a),s=n.scrollHeight-n.clientHeight,i=n.scrollWidth-n.clientWidth,c=document.defaultView.getComputedStyle(n),u="auto"===c.overflowY||"scroll"===c.overflowY,d="auto"===c.overflowX||"scroll"===c.overflowX,v=s&&u,f=i&&d;return!!(l&&(!v||v&&(n.scrollTop>=s&&o<0||n.scrollTop<=0&&o>0))||r&&(!f||f&&(n.scrollLeft>=i&&a<0||n.scrollLeft<=0&&a>0)))&&e(t,n.parentNode,a,o)},Q=globalThis&&globalThis.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},ee={},te=d({inheritAttrs:!1,props:e(e({},H()),{getContainer:Function,getOpenCount:Function,scrollLocker:t.any,switchScrollingEffect:Function}),emits:["close","handleClick","change"],setup:function(t,l){var r,s=l.emit,i=l.slots,c=v({startPos:{x:null,y:null}}),u=f(),d=f(),w=f(),C=f(),k=f(),x=[],E="drawer_id_".concat(Number((Date.now()+Math.random()).toString().replace(".",Math.round(9*Math.random()).toString())).toString(16)),O=!(G||!F)&&{passive:!1};p((function(){h((function(){var e,n=t.open,a=t.getContainer,o=t.showMask,l=t.autofocus,r=null==a?void 0:a();H(t),n&&(r&&r.parentNode===document.body&&(ee[E]=n),V(),h((function(){l&&S()})),o&&(null===(e=t.scrollLocker)||void 0===e||e.lock()))}))})),y((function(){return t.level}),(function(){H(t)}),{flush:"post"}),y((function(){return t.open}),(function(){var e=t.open,n=t.getContainer,a=t.scrollLocker,o=t.showMask,l=t.autofocus,r=null==n?void 0:n();r&&r.parentNode===document.body&&(ee[E]=!!e),V(),e?(l&&S(),o&&(null==a||a.lock())):null==a||a.unLock()}),{flush:"post"}),m((function(){var e,n=t.open;delete ee[E],n&&(_(!1),document.body.style.touchAction=""),null===(e=t.scrollLocker)||void 0===e||e.unLock()})),y((function(){return t.placement}),(function(e){e&&(k.value=null)}));var S=function(){var e,t;null===(t=null===(e=d.value)||void 0===e?void 0:e.focus)||void 0===t||t.call(e)},L=function(e){e.touches.length>1||(c.startPos={x:e.touches[0].clientX,y:e.touches[0].clientY})},j=function(e){if(!(e.changedTouches.length>1)){var t=e.currentTarget,n=e.changedTouches[0].clientX-c.startPos.x,a=e.changedTouches[0].clientY-c.startPos.y;(t===w.value||t===C.value||t===k.value&&J(t,e.target,n,a))&&e.cancelable&&e.preventDefault()}},T=function e(t){var n=t.target;q(n,D,e),n.style.transition=""},N=function(e){s("close",e)},M=function(e){e.keyCode===Y.ESC&&(e.stopPropagation(),N(e))},P=function(e){var n=t.open,a=t.afterVisibleChange;e.target===u.value&&e.propertyName.match(/transform$/)&&(d.value.style.transition="",!n&&z()&&(document.body.style.overflowX="",w.value&&(w.value.style.left="",w.value.style.width="")),a&&a(!!n))},B=g((function(){var e=t.placement,n="left"===e||"right"===e;return{isHorizontal:n,placementName:"translate".concat(n?"X":"Y")}})),V=function(){var e=t.open,n=t.width,a=t.height,o=B.value,l=o.isHorizontal,r=o.placementName,s=k.value?k.value.getBoundingClientRect()[l?"width":"height"]:0;I(e,r,(l?n:a)||s)},_=function(e,n,a,o){var l=t.placement,r=t.levelMove,s=t.duration,i=t.ease,c=t.showMask;x.forEach((function(t){t.style.transition="transform ".concat(s," ").concat(i),K(t,D,T);var u,d,v,f=e?a:0;if(r){var p=(d={target:t,open:e},v="function"==typeof(u=r)?u(d):u,Array.isArray(v)?2===v.length?v:[v[0],v[1]]:[v]);f=e?p[0]:p[1]||0}var h="number"==typeof f?"".concat(f,"px"):f,y="left"===l||"top"===l?h:"-".concat(h);y=c&&"right"===l&&o?"calc(".concat(y," + ").concat(o,"px)"):y,t.style.transform=f?"".concat(n,"(").concat(y,")"):""}))},I=function(e,t,n){if(!G){var a=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth?A(!0):0;_(e,t,n,a),R(a)}s("change",e)},R=function(e){var n=t.getContainer,a=t.showMask,o=t.open,l=null==n?void 0:n();if(l&&l.parentNode===document.body&&a){var r=["touchstart"],s=[document.body,w.value,C.value,k.value];o&&"hidden"!==document.body.style.overflow?(e&&X(e),document.body.style.touchAction="none",s.forEach((function(e,t){e&&K(e,r[t]||"touchmove",t?j:L,O)}))):z()&&(document.body.style.touchAction="",e&&W(e),s.forEach((function(e,t){e&&q(e,r[t]||"touchmove",t?j:L,O)})))}},X=function(e){var n=t.placement,a=t.duration,o=t.ease,l="width ".concat(a," ").concat(o),s="transform ".concat(a," ").concat(o);switch(d.value.style.transition="none",n){case"right":d.value.style.transform="translateX(-".concat(e,"px)");break;case"top":case"bottom":d.value.style.width="calc(100% - ".concat(e,"px)"),d.value.style.transform="translateZ(0)"}clearTimeout(r),r=setTimeout((function(){d.value&&(d.value.style.transition="".concat(s,",").concat(l),d.value.style.width="",d.value.style.transform="")}))},W=function(e){var n,a=t.placement,o=t.duration,l=t.ease;d.value.style.transition="none";var s="width ".concat(o," ").concat(l),i="transform ".concat(o," ").concat(l);switch(a){case"left":d.value.style.width="100%",s="width 0s ".concat(l," ").concat(o);break;case"right":d.value.style.transform="translateX(".concat(e,"px)"),d.value.style.width="100%",s="width 0s ".concat(l," ").concat(o),w.value&&(w.value.style.left="-".concat(e,"px"),w.value.style.width="calc(100% + ".concat(e,"px)"));break;case"top":case"bottom":d.value.style.width="calc(100% + ".concat(e,"px)"),d.value.style.height="100%",d.value.style.transform="translateZ(0)",n="height 0s ".concat(l," ").concat(o)}clearTimeout(r),r=setTimeout((function(){d.value&&(d.value.style.transition="".concat(i,",").concat(n?"".concat(n,","):"").concat(s),d.value.style.transform="",d.value.style.width="",d.value.style.height="")}))},z=function(){return!Object.keys(ee).some((function(e){return ee[e]}))},H=function(e){var t=e.level,n=e.getContainer;if(!G){var a,o=null==n?void 0:n(),l=o?o.parentNode:null;if(x=[],"all"===t)(l?Array.prototype.slice.call(l.children):[]).forEach((function(e){"SCRIPT"!==e.nodeName&&"STYLE"!==e.nodeName&&"LINK"!==e.nodeName&&e!==o&&x.push(e)}));else t&&(a=t,Array.isArray(a)?a:[a]).forEach((function(e){document.querySelectorAll(e).forEach((function(e){x.push(e)}))}))}},$=function(e){s("handleClick",e)},te=f(!1);return y(d,(function(){h((function(){te.value=!0}))})),function(){var l,r,s,c=t.width,v=t.height,f=t.open,p=t.prefixCls,h=t.placement;t.level,t.levelMove,t.ease,t.duration,t.getContainer,t.onChange,t.afterVisibleChange;var y=t.showMask,m=t.maskClosable,g=t.maskStyle,x=t.keyboard;t.getOpenCount,t.scrollLocker;var E=t.contentWrapperStyle,O=t.style,S=t.class,L=Q(t,["width","height","open","prefixCls","placement","level","levelMove","ease","duration","getContainer","onChange","afterVisibleChange","showMask","maskClosable","maskStyle","keyboard","getOpenCount","scrollLocker","contentWrapperStyle","style","class"]),j=f&&te.value,T=n(p,(a(l={},"".concat(p,"-").concat(h),!0),a(l,"".concat(p,"-open"),j),a(l,S,!!S),a(l,"no-mask",!y),l)),V=B.value.placementName,_="left"===h||"top"===h?"-100%":"100%",I=j?"":"".concat(V,"(").concat(_,")");return b("div",o(o({},U(L,["switchScrollingEffect","autofocus"])),{},{tabindex:-1,class:T,style:O,ref:d,onKeydown:j&&x?M:void 0,onTransitionend:P}),[y&&b("div",{class:"".concat(p,"-mask"),onClick:m?N:void 0,style:g,ref:w},null),b("div",{class:"".concat(p,"-content-wrapper"),style:e({transform:I,msTransform:I,width:Z(c)?"".concat(c,"px"):c,height:Z(v)?"".concat(v,"px"):v},E),ref:u},[b("div",{class:"".concat(p,"-content"),ref:k},[null===(r=i.default)||void 0===r?void 0:r.call(i)]),i.handler?b("div",{onClick:$,ref:C},[null===(s=i.handler)||void 0===s?void 0:s.call(i)]):null])])}}}),ne=globalThis&&globalThis.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},ae=d({inheritAttrs:!1,props:W(e(e({},H()),{forceRender:{type:Boolean,default:void 0},getContainer:t.oneOfType([t.string,t.func,t.object,t.looseBool])}),{prefixCls:"drawer",placement:"left",getContainer:"body",level:"all",duration:".3s",ease:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",afterVisibleChange:function(){},showMask:!0,maskClosable:!0,maskStyle:{},wrapperClassName:"",keyboard:!0,forceRender:!1,autofocus:!0}),emits:["handleClick","close"],slots:["handler"],setup:function(e,t){var n=t.emit,a=t.slots,l=f(null),r=function(e){n("handleClick",e)},s=function(e){n("close",e)};return function(){e.afterVisibleChange;var t=e.getContainer,n=e.wrapperClassName,i=e.forceRender,c=ne(e,["afterVisibleChange","getContainer","wrapperClassName","forceRender"]),u=null;if(!t)return b("div",{class:n,ref:l},[b(te,o(o({},c),{},{open:e.open,getContainer:function(){return l.value},onClose:s,onHandleClick:r}),a)]);var d=!!a.handler||i;return(d||e.open||l.value)&&(u=b(X,{visible:e.open,forceRender:d,getContainer:t,wrapperClassName:n},{default:function(t){var n=t.visible,i=t.afterClose,u=ne(t,["visible","afterClose"]);return b(te,o(o(o({ref:l},c),u),{},{open:void 0!==n?n:e.open,afterVisibleChange:void 0!==i?i:e.afterVisibleChange,onClose:s,onHandleClick:r}),a)}})),u}}}),oe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},le=r("top","right","bottom","left");r("default","large");var re={distance:180},se=l(d({name:"ADrawer",inheritAttrs:!1,props:W({autofocus:{type:Boolean,default:void 0},closable:{type:Boolean,default:void 0},closeIcon:t.any,destroyOnClose:{type:Boolean,default:void 0},forceRender:{type:Boolean,default:void 0},getContainer:t.any,maskClosable:{type:Boolean,default:void 0},mask:{type:Boolean,default:void 0},maskStyle:{type:Object,default:void 0},wrapStyle:{type:Object,default:void 0},style:{type:Object,default:void 0},class:t.any,wrapClassName:String,size:{type:String},drawerStyle:{type:Object,default:void 0},headerStyle:{type:Object,default:void 0},bodyStyle:{type:Object,default:void 0},contentWrapperStyle:{type:Object,default:void 0},title:t.any,visible:{type:Boolean,default:void 0},width:t.oneOfType([t.string,t.number]),height:t.oneOfType([t.string,t.number]),zIndex:Number,prefixCls:String,push:t.oneOfType([t.looseBool,{type:Object}]),placement:t.oneOf(le),keyboard:{type:Boolean,default:void 0},extra:t.any,footer:t.any,footerStyle:{type:Object,default:void 0},level:t.any,levelMove:{type:[Number,Array,Function]},handle:t.any,afterVisibleChange:Function,onAfterVisibleChange:Function,"onUpdate:visible":Function,onClose:Function},{closable:!0,placement:"right",maskClosable:!0,mask:!0,level:null,keyboard:!0,push:re}),slots:["closeIcon","title","extra","footer","handle"],setup:function(t,o){var l=o.emit,r=o.slots,d=o.attrs,v=f(!1),k=f(!1),x=f(null),E=w("parentDrawerOpts",null),O=s("drawer",t).prefixCls;i(!t.afterVisibleChange,"Drawer","`afterVisibleChange` prop is deprecated, please use `@afterVisibleChange` event instead"),i(void 0===t.wrapStyle,"Drawer","`wrapStyle` prop is deprecated, please use `style` instead"),i(void 0===t.wrapClassName,"Drawer","`wrapClassName` prop is deprecated, please use `class` instead");C("parentDrawerOpts",{setPush:function(){v.value=!0},setPull:function(){v.value=!1,h((function(){S()}))}}),p((function(){t.visible&&E&&E.setPush()})),m((function(){E&&E.setPull()})),y((function(){return t.visible}),(function(e){E&&(e?E.setPush():E.setPull())}),{flush:"post"});var S=function(){var e,t;null===(t=null===(e=x.value)||void 0===e?void 0:e.domFocus)||void 0===t||t.call(e)},L=function(e){l("update:visible",!1),l("close",e)},j=function(e){var n;null===(n=t.afterVisibleChange)||void 0===n||n.call(t,e),l("afterVisibleChange",e)},T=g((function(){return t.destroyOnClose&&!t.visible})),N=function(){T.value&&(t.visible||(k.value=!0))},M=g((function(){var e,n=t.push,a=t.placement;return e="boolean"==typeof n?n?re.distance:0:n.distance,e=parseFloat(String(e||0)),"left"===a||"right"===a?"translateX(".concat("left"===a?e:-e,"px)"):"top"===a||"bottom"===a?"translateY(".concat("top"===a?e:-e,"px)"):null})),P=g((function(){var e=t.visible,n=t.mask,a=t.placement,o=t.size,l=void 0===o?"default":o,r=t.width,s=t.height;if(!e&&!n)return{};var i={};if("left"===a||"right"===a){var c="large"===l?736:378;i.width=void 0===r?c:r,i.width="string"==typeof i.width?i.width:"".concat(i.width,"px")}else{var u="large"===l?736:378;i.height=void 0===s?u:s,i.height="string"==typeof i.height?i.height:"".concat(i.height,"px")}return i})),B=g((function(){var n=t.zIndex,a=t.wrapStyle,o=t.mask,l=t.style,r=o?{}:P.value;return e(e(e({zIndex:n,transform:v.value?M.value:void 0},r),a),l)})),V=function(e){var o=t.closable,l=t.headerStyle,s=c(r,t,"extra"),i=c(r,t,"title");return i||o?b("div",{class:n("".concat(e,"-header"),a({},"".concat(e,"-header-close-only"),o&&!i&&!s)),style:l},[b("div",{class:"".concat(e,"-header-title")},[_(e),i&&b("div",{class:"".concat(e,"-title")},[i])]),s&&b("div",{class:"".concat(e,"-extra")},[s])]):null},_=function(e){var n,a=t.closable,o=r.closeIcon?null===(n=r.closeIcon)||void 0===n?void 0:n.call(r):t.closeIcon;return a&&b("button",{key:"closer",onClick:L,"aria-label":"Close",class:"".concat(e,"-close")},[void 0===o?b(u,null,null):o])},I=function(e){var n=c(r,t,"footer");if(!n)return null;var a="".concat(e,"-footer");return b("div",{class:a,style:t.footerStyle},[n])};return function(){var o;t.width,t.height;var l=t.visible,s=t.placement,i=t.mask,c=t.wrapClassName,u=t.class,v=oe(t,["width","height","visible","placement","mask","wrapClassName","class"]),f=i?P.value:{},p=i?"":"no-mask",h=e(e(e(e({},d),U(v,["size","closeIcon","closable","destroyOnClose","drawerStyle","headerStyle","bodyStyle","title","push","wrapStyle","onAfterVisibleChange","onClose","onUpdate:visible"])),f),{onClose:L,afterVisibleChange:j,handler:!1,prefixCls:O.value,open:l,showMask:i,placement:s,class:n((o={},a(o,u,u),a(o,c,!!c),a(o,p,!!p),o)),style:B.value,ref:x});return b(ae,h,{handler:t.handle?function(){return t.handle}:r.handle,default:function(){return function(n){var a;if(k.value&&!t.visible)return null;k.value=!1;var o=t.bodyStyle,l=t.drawerStyle,s={};return T.value&&(s.opacity=0,s.transition="opacity .3s"),b("div",{class:"".concat(n,"-wrapper-body"),style:e(e({},s),l),onTransitionend:N},[V(n),b("div",{key:"body",class:"".concat(n,"-body"),style:o},[null===(a=r.default)||void 0===a?void 0:a.call(r)]),I(n)])}(O.value)}})}}}));const ie=(e,t,n,a=!0)=>{const o="ontouchstart"in document.documentElement,l=e.getContext("2d");function r(e,t,n,a){l&&(l.beginPath(),l.moveTo(e,t),l.lineTo(n,a),l.stroke())}l&&(l.fillStyle=t,l.strokeStyle=t,l.lineWidth=n,l.lineCap="round");let s,i=!1;function c(e){i=!0;const t=e.touches[0].pageX,n=e.touches[0].pageY;s=[t,n]}function u(e){i=!0;const t=e.touches[0].pageX,n=e.touches[0].pageY;r(s[0],s[1],t,n),s=[t,n]}function d(){i=!1}function v(e){i=!0,s=[e.offsetX,e.offsetY]}function f(e){i&&(r(s[0],s[1],e.offsetX,e.offsetY),s=[e.offsetX,e.offsetY])}document.getElementById("clear").addEventListener("click",(()=>{o?(e.removeEventListener("touchstart",c,!1),e.removeEventListener("touchmove",u,!1),e.removeEventListener("touchend",d,!1)):(e.removeEventListener("mousedown",v),e.removeEventListener("mousemove",f),e.removeEventListener("mouseup",d))})),o&&a?(e.addEventListener("touchstart",c,!1),e.addEventListener("touchmove",u,!1),e.addEventListener("touchend",d,!1)):!o&&a&&(e.addEventListener("mousedown",v),e.addEventListener("mousemove",f),e.addEventListener("mouseup",d))};const ce=e=>(B("data-v-e18b2aec"),e=e(),V(),e),ue={class:"wrap"},de={id:"canvasWrap"},ve={class:"selector"},fe=P("画板设置"),pe=P("清空画布内容"),he=P("橡皮擦"),ye=P("继续绘画"),me=P("导出为文件"),ge=P("发布图片"),be={class:"setting"},we={class:"section"},Ce=ce((()=>O("svg",{class:"icon","aria-hidden":"true"},[O("use",{"xlink:href":"#icon-beijingyanse"})],-1))),ke={class:"section"},xe={class:"section"},Ee=ce((()=>O("svg",{class:"icon","aria-hidden":"true"},[O("use",{"xlink:href":"#icon-beijingyanse"})],-1))),Oe={class:"section changeHeight"},Se={class:"section"};var Le=k(d({__name:"Canvas",setup(e){const t=I(),n=f(),a=f("#000000"),o=f(4),l=f("#ffffff"),r=f(parseInt(document.body.getBoundingClientRect().height.toString(),10)),s=()=>{ie(n.value,a.value,o.value)};p((()=>{n.value.width=document.body.getBoundingClientRect().width,n.value.height=document.body.getBoundingClientRect().height,ie(n.value,a.value,o.value)}));const i=f(!1),c=()=>{i.value=!0},u=async()=>{const e=await(async()=>{let e;try{e=await _.canvasToImg(n.value,1,"image")}catch(t){}return e})();n.value.width=document.body.getBoundingClientRect().width,n.value.height=r.value;n.value.getContext("2d").drawImage(e,0,0),s(),i.value=!1},d=()=>{const e=n.value.getContext("2d");l.value="#ffffff",e&&(e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,n.value.width,n.value.height),e.restore())},v=f();function h(e){const t=e.touches[0].pageX,n=e.touches[0].pageY;v.value.style.top=`${n}px`,v.value.style.left=`${t}px`}function y(e){v.value.style.display="block";const t=e.touches[0].pageX,a=e.touches[0].pageY;v.value.style.top=`${a}px`,v.value.style.left=`${t}px`;n.value.getContext("2d").clearRect(t,a,w.value,w.value)}function m(){v.value.style.display="none",n.value.removeEventListener("touchstart",h),n.value.removeEventListener("touchmove",y),n.value.removeEventListener("touchend",m)}const g=f(!1),w=f(20);function C(e){g.value=!0;const t=e.offsetX,n=e.offsetY;v.value.style.top=`${n}px`,v.value.style.left=`${t}px`}function k(e){if(g.value){const t=e.offsetX,a=e.offsetY;v.value.style.display="block",v.value.style.top=`${a}px`,v.value.style.left=`${t}px`;n.value.getContext("2d").clearRect(t,a,w.value,w.value)}}function P(){g.value=!1,v.value.style.display="none",n.value.removeEventListener("mousedown",C),n.value.removeEventListener("mousemove",k),document.documentElement.removeEventListener("mouseup",P)}const B=()=>{ie(n.value,a.value,o.value)},V=()=>{ie(n.value,"transparent",1,!1);"ontouchstart"in document.documentElement?(n.value.addEventListener("touchstart",h),n.value.addEventListener("touchmove",y),n.value.addEventListener("touchend",m)):(n.value.addEventListener("mousedown",C),n.value.addEventListener("mousemove",k),document.documentElement.addEventListener("mouseup",P))},A=async()=>{const e=`${Math.floor(1e4*Math.random())}.png`,t=await _.canvasToUrl(n.value,1,"image/png",l.value,r.value),a=_.dataURLtoBlob(t);if("download"in document.createElement("a")){const t=document.createElement("a");t.download=e,t.style.display="none",t.href=URL.createObjectURL(a),document.body.appendChild(t),t.click(),URL.revokeObjectURL(t.href),document.body.removeChild(t)}},X=async()=>{const e=await _.canvasToUrl(n.value,1,"image/png",l.value,r.value);t.uploadImg({content:e,isPublic:!1}).then((()=>R("success","发布成功",2e3)))};return(e,t)=>{const f=z,p=se;return x(),E("div",ue,[O("div",de,[O("canvas",{ref_key:"canvasEl",ref:n,style:S({background:l.value}),class:"canvasEl"},null,4),O("div",ve,[b(f,{type:"primary",onClick:c},{default:L((()=>[fe])),_:1}),b(f,{type:"primary",onClick:d},{default:L((()=>[pe])),_:1}),b(f,{type:"primary",id:"clear",onClick:j(V,["prevent"])},{default:L((()=>[he])),_:1},8,["onClick"]),b(f,{type:"primary",onClick:B},{default:L((()=>[ye])),_:1}),b(f,{type:"primary",onClick:A},{default:L((()=>[me])),_:1}),b(f,{type:"primary",onClick:X},{default:L((()=>[ge])),_:1})])]),b(p,{visible:i.value,"onUpdate:visible":t[5]||(t[5]=e=>i.value=e),class:"custom-class",width:"30%",closable:!1,title:"画板设置",placement:"right"},{default:L((()=>[O("div",be,[O("div",we,[O("p",null,"线条颜色:"+T(a.value),1),O("label",null,[Ce,N(O("input",{type:"color","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),onChange:s},null,544),[[M,a.value]])])]),O("div",ke,[O("p",null,"线条宽度:"+T(o.value),1),O("label",null,[N(O("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),onChange:s,style:{"max-width":"50px"}},null,544),[[M,o.value,void 0,{number:!0}]])])]),O("div",xe,[O("p",null,"画布颜色:"+T(l.value),1),O("label",null,[Ee,N(O("input",{type:"color","onUpdate:modelValue":t[2]||(t[2]=e=>l.value=e),onChange:s},null,544),[[M,l.value]])])]),O("div",Oe,[O("p",null,"画布高度:"+T(r.value),1),O("label",null,[N(O("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>r.value=e),style:{"max-width":"50px"},onChange:u},null,544),[[M,r.value,void 0,{number:!0}]])])]),O("div",Se,[O("p",null,"橡皮擦宽度:"+T(w.value),1),O("label",null,[N(O("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>w.value=e),style:{"max-width":"50px"}},null,512),[[M,w.value,void 0,{number:!0}]])])])])])),_:1},8,["visible"]),O("div",{ref_key:"clearTag",ref:v,id:"clearTag"},null,512)])}}}),[["__scopeId","data-v-e18b2aec"]]);export{Le as default};
