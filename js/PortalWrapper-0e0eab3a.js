import{b as e,P as t,n,w as o,O as i,_ as r}from"./default-25c25008.js";import{P as a}from"./Portal-927a45f6.js";import{_ as c,a as l}from"./classCallCheck-5d344be6.js";import{d as u,r as d,J as s,f,w as v,n as m,o as p,c as h,g}from"./index-771f7fc0.js";var y;function w(e){if("undefined"==typeof document)return 0;if(e||void 0===y){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var n=document.createElement("div"),o=n.style;o.position="absolute",o.top="0",o.left="0",o.pointerEvents="none",o.visibility="hidden",o.width="200px",o.height="150px",o.overflow="hidden",n.appendChild(t),document.body.appendChild(n);var i=t.offsetWidth;n.style.overflow="scroll";var r=t.offsetWidth;i===r&&(r=n.clientWidth),document.body.removeChild(n),y=i-r}return y}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.element,o=void 0===n?document.body:n,i={},r=Object.keys(e);return r.forEach((function(e){i[e]=o.style[e]})),r.forEach((function(t){o.style[t]=e[t]})),i}var C={},k=function(e){if(document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth||e){var t="ant-scrolling-effect",n=new RegExp("".concat(t),"g"),o=document.body.className;if(e){if(!n.test(o))return;return b(C),C={},void(document.body.className=o.replace(n,"").trim())}var i=w();if(i&&(C=b({position:"relative",width:"calc(100% - ".concat(i,"px)")}),!n.test(o))){var r="".concat(o," ").concat(t);document.body.className=r.trim()}}},N=[],E=new RegExp("".concat("ant-scrolling-effect"),"g"),x=0,T=new Map,W=c((function t(n){var o=this;l(this,t),this.getContainer=function(){var e;return null===(e=o.options)||void 0===e?void 0:e.container},this.reLock=function(e){var t=N.find((function(e){return e.target===o.lockTarget}));t&&o.unLock(),o.options=e,t&&(t.options=e,o.lock())},this.lock=function(){var t;if(!N.some((function(e){return e.target===o.lockTarget})))if(N.some((function(e){var t,n=e.options;return(null==n?void 0:n.container)===(null===(t=o.options)||void 0===t?void 0:t.container)})))N=[].concat(e(N),[{target:o.lockTarget,options:o.options}]);else{var n=0,i=(null===(t=o.options)||void 0===t?void 0:t.container)||document.body;(i===document.body&&window.innerWidth-document.documentElement.clientWidth>0||i.scrollHeight>i.clientHeight)&&(n=w());var r=i.className;if(0===N.filter((function(e){var t,n=e.options;return(null==n?void 0:n.container)===(null===(t=o.options)||void 0===t?void 0:t.container)})).length&&T.set(i,b({width:0!==n?"calc(100% - ".concat(n,"px)"):void 0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden"},{element:i})),!E.test(r)){var a="".concat(r," ").concat("ant-scrolling-effect");i.className=a.trim()}N=[].concat(e(N),[{target:o.lockTarget,options:o.options}])}},this.unLock=function(){var e,t=N.find((function(e){return e.target===o.lockTarget}));if(N=N.filter((function(e){return e.target!==o.lockTarget})),t&&!N.some((function(e){var n,o=e.options;return(null==o?void 0:o.container)===(null===(n=t.options)||void 0===n?void 0:n.container)}))){var n=(null===(e=o.options)||void 0===e?void 0:e.container)||document.body,i=n.className;E.test(i)&&(b(T.get(n),{element:n}),T.delete(n),n.className=n.className.replace(E,"").trim())}},this.lockTarget=x++,this.options=n})),j=0,H=i(),L={},P=function(e){if(!H)return null;if(e){if("string"==typeof e)return document.querySelectorAll(e)[0];if("function"==typeof e)return e();if("object"===r(e)&&e instanceof window.HTMLElement)return e}return document.body},S=u({name:"PortalWrapper",inheritAttrs:!1,props:{wrapperClassName:String,forceRender:{type:Boolean,default:void 0},getContainer:t.any,visible:{type:Boolean,default:void 0}},setup:function(e,t){var i=t.slots,r=d(),c=d(),l=d(),u=new W({container:P(e.getContainer)}),y=function(){var e,t;null===(t=null===(e=r.value)||void 0===e?void 0:e.parentNode)||void 0===t||t.removeChild(r.value)},w=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t||r.value&&!r.value.parentNode){var n=P(e.getContainer);return!!n&&(n.appendChild(r.value),!0)}return!0},C=function(){return H?(r.value||(r.value=document.createElement("div"),w(!0)),N(),r.value):null},N=function(){var t=e.wrapperClassName;r.value&&t&&t!==r.value.className&&(r.value.className=t)};s((function(){N(),w()}));var E=function(){1!==j||Object.keys(L).length?j||(b(L),L={},k(!0)):(k(),L=b({overflow:"hidden",overflowX:"hidden",overflowY:"hidden"}))},x=g();return f((function(){var t=!1;v([function(){return e.visible},function(){return e.getContainer}],(function(o,i){var r=n(o,2),a=r[0],c=r[1],l=n(i,2),d=l[0],s=l[1];(H&&P(e.getContainer)===document.body&&(a&&!d?j+=1:t&&(j-=1)),t)&&(("function"==typeof c&&"function"==typeof s?c.toString()!==s.toString():c!==s)&&y(),a&&a!==d&&H&&P(c)!==u.getContainer()&&u.reLock({container:P(c)}));t=!0}),{immediate:!0,flush:"post"}),m((function(){w()||(l.value=o((function(){x.update()})))}))})),p((function(){var t=e.visible,n=e.getContainer;H&&P(n)===document.body&&(j=t&&j?j-1:j),y(),o.cancel(l.value)})),function(){var t=e.forceRender,n=e.visible,o=null,r={getOpenCount:function(){return j},getContainer:C,switchScrollingEffect:E,scrollLocker:u};return(t||n||c.value)&&(o=h(a,{getContainer:C,ref:c},{default:function(){var e;return null===(e=i.default)||void 0===e?void 0:e.call(i,r)}})),o}}});export{S as P,w as g};
