import{P as a,c as n,l as e,m as t,a as r,_ as s,f as c}from"./default-add53953.js";import{r as u,a as i,b as l}from"./user-139840af.js";import{r as o,j as f,x as v,E as p,w as g,d,a as m,s as x,B as b,c as h}from"./index-461f95cc.js";import{R as y}from"./index-761661f6.js";function S(){var a=o({}),n=null;return f((function(){n=u.subscribe((function(n){a.value=n}))})),v((function(){u.unsubscribe(n)})),a}function z(a){var n=p();return g((function(){n.value=a()}),{flush:"sync"}),n}var j=d({name:"AAvatar",inheritAttrs:!1,props:{prefixCls:String,shape:{type:String,default:"circle"},size:{type:[Number,String,Object],default:function(){return"default"}},src:String,srcset:String,icon:a.any,alt:String,gap:Number,draggable:{type:Boolean,default:void 0},crossOrigin:String,loadError:{type:Function}},slots:["icon"],setup:function(a,u){var v=u.slots,p=u.attrs,g=o(!0),d=o(!1),j=o(1),A=o(null),E=o(null),w=n("avatar",a).prefixCls,H=i(),O=m((function(){return"default"===a.size?H.value:a.size})),W=S(),B=z((function(){if("object"===e(a.size)){var n=l.find((function(a){return W.value[a]}));return a.size[n]}})),C=function(){if(A.value&&E.value){var n=A.value.offsetWidth,e=E.value.offsetWidth;if(0!==n&&0!==e){var t=a.gap,r=void 0===t?4:t;2*r<e&&(j.value=e-2*r<n?(e-2*r)/n:1)}}},N=function(){var n=a.loadError;!1!==(null==n?void 0:n())&&(g.value=!1)};return x((function(){return a.src}),(function(){b((function(){g.value=!0,j.value=1}))})),x((function(){return a.gap}),(function(){b((function(){C()}))})),f((function(){b((function(){C(),d.value=!0}))})),function(){var n,e,u,i,l=a.shape,o=a.src,f=a.alt,m=a.srcset,x=a.draggable,b=a.crossOrigin,S=t(v,a,"icon"),z=w.value,H=(r(n={},"".concat(p.class),!!p.class),r(n,z,!0),r(n,"".concat(z,"-lg"),"large"===O.value),r(n,"".concat(z,"-sm"),"small"===O.value),r(n,"".concat(z,"-").concat(l),l),r(n,"".concat(z,"-image"),o&&g.value),r(n,"".concat(z,"-icon"),S),n),W="number"==typeof O.value?{width:"".concat(O.value,"px"),height:"".concat(O.value,"px"),lineHeight:"".concat(O.value,"px"),fontSize:S?"".concat(O.value/2,"px"):"18px"}:{},R=null===(e=v.default)||void 0===e?void 0:e.call(v);if(o&&g.value)u=h("img",{draggable:x,src:o,srcset:m,onError:N,alt:f,crossorigin:b},null);else if(S)u=S;else if(d.value||1!==j.value){var T="scale(".concat(j.value,") translateX(-50%)"),k={msTransform:T,WebkitTransform:T,transform:T},F="number"==typeof O.value?{lineHeight:"".concat(O.value,"px")}:{};u=h(y,{onResize:C},{default:function(){return[h("span",{class:"".concat(z,"-string"),ref:A,style:s(s({},F),k)},[R])]}})}else u=h("span",{class:"".concat(z,"-string"),ref:A,style:{opacity:0}},[R]);return h("span",c(c({},p),{},{ref:E,class:H,style:[W,(i=!!S,B.value?{width:"".concat(B.value,"px"),height:"".concat(B.value,"px"),lineHeight:"".concat(B.value,"px"),fontSize:"".concat(i?B.value/2:18,"px")}:{}),p.style]}),[u])}}});export{j as A,z as e,S as u};
