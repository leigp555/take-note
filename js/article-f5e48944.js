import{m as t}from"./index-461f95cc.js";import{h as e,T as r}from"./axios-10bb5b34.js";const i=t("articleInfo",{state:()=>({title:"",body:"",num:{allArticle:0,favorite:0,draft:0,deleted:0},scrollHeight:0,tabNum:"1"}),getters:{},actions:{getLastArticle(){let t={title:"",body:""};try{t=JSON.parse(window.localStorage.getItem("temp_save")),this.title=t.title,this.body=t.body}catch(e){this.title="",this.body=""}},saveLocal(){const t=JSON.stringify({title:this.title,body:this.body});window.localStorage.setItem("temp_save",t)},async createArticle(t={isPublic:!1,state:"normal"}){try{const{article:r}=await e("/article","POST",{title:this.title,body:this.body,isPublic:t.isPublic,state:t.state}),i=JSON.stringify({title:"",body:""});return this.title="",this.body="",this.scrollHeight=0,window.localStorage.setItem("temp_save",i),Promise.resolve(r)}catch(r){return Promise.reject(r)}},continueEdit(t){this.getOneArticle(t).then((e=>{this.title=e.articles.title,this.body=e.articles.body,this.saveLocal(),this.deleteArticle(t).catch((()=>{}))})).catch((()=>{r("error","请重试",2e3)}))},async deleteArticle(t){try{const{msg:r}=await e("/article/delete","POST",{identity_number:t.identity_number});return Promise.resolve({msg:r})}catch(r){return Promise.reject(r)}},async updateArticle(t){try{const{msg:r}=await e("/article","PATCH",{identity_number:t.identity_number,owner:t.owner,title:t.title,body:t.body,isPublic:t.isPublic,state:t.state});return Promise.resolve({msg:r})}catch(r){return Promise.reject(r)}},async getAllArticle(t){try{const r=await e("/article/all","GET",{offset:t.offset,limit:t.limit});return Promise.resolve({articles:r.articles})}catch(r){return Promise.reject(r)}},async getNumArticle(t){try{if("allArticle"===t.kind){const t=await e("/article/num/allArticle","GET");return this.num.allArticle=t.total,Promise.resolve({total_article:t.total})}if("favorite"===t.kind){const t=await e("/article/num/favorite","GET");return this.num.favorite=t.total,Promise.resolve({total_article:t.total})}if("draft"===t.kind){const t=await e("/article/num/draft","GET");return this.num.draft=t.total,Promise.resolve({total_article:t.total})}if("deleted"===t.kind){const t=await e("/article/num/deleted","GET");return this.num.deleted=t.total,Promise.resolve({total_article:t.total})}}catch(r){return Promise.reject(r)}},async getOneArticle(t){try{const r=await e("/article/identify","GET",{identity_number:t.identity_number});return Promise.resolve({articles:r.articles[0]})}catch(r){return Promise.reject(r)}},async getFavoriteArticle(t){try{const r=await e("/article/favorite","GET",{offset:t.offset,limit:t.limit});return Promise.resolve({articles:r.articles})}catch(r){return Promise.reject(r)}},async getDraftArticle(t){try{const r=await e("/article/draft","GET",{offset:t.offset,limit:t.limit});return Promise.resolve({articles:r.articles})}catch(r){return Promise.reject(r)}},async deletedArticle(t){try{const{msg:r}=await e("/article/deleted","POST",{identity_number:t.identity_number});return Promise.resolve({msg:r})}catch(r){return Promise.reject(r)}},async getDeletedArticle(t){try{const r=await e("/article/deleted","GET",{offset:t.offset,limit:t.limit});return Promise.resolve({articles:r.articles})}catch(r){return Promise.reject(r)}},async searchArticle(t){try{const r=await e("/article/search","GET",{keyword:t.keyword,offset:t.offset,limit:t.limit});return Promise.resolve({articles:r.articles})}catch(r){return Promise.reject(r)}}}});export{i as a};
