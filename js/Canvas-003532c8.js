import{a as e,P as t,j as n,c as a,e as o,o as l,l as r,D as i,x as s,u as c,d as u,g as d,C as v}from"./default-924e29b3.js";import{B as f}from"./index-4e132aca.js";import{d as p,D as h,r as y,f as m,n as g,w as b,H as w,b as C,c as k,i as x,p as E,_ as O,m as S,q as L,s as j,$ as T,x as N,O as B,V as M,e as P,R,S as V,y as I,z as _}from"./index-bc736a08.js";import{g as A,P as X}from"./PortalWrapper-6e67049d.js";import{K as U}from"./KeyCode-a2a1cb88.js";import{s as Y}from"./Portal-9b6fb3f4.js";import"./classCallCheck-5d344be6.js";var D=function(){return{prefixCls:String,width:t.oneOfType([t.string,t.number]),height:t.oneOfType([t.string,t.number]),style:{type:Object,default:void 0},class:String,placement:{type:String},wrapperClassName:String,level:{type:[String,Array]},levelMove:{type:[Number,Function,Array]},duration:String,ease:String,showMask:{type:Boolean,default:void 0},maskClosable:{type:Boolean,default:void 0},maskStyle:{type:Object,default:void 0},afterVisibleChange:Function,keyboard:{type:Boolean,default:void 0},contentWrapperStyle:{type:Object,default:void 0},autofocus:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0}}};var F={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend"},W=F[Object.keys(F).filter((function(e){if("undefined"==typeof document)return!1;var t=document.getElementsByTagName("html")[0];return e in(t?t.style:{})}))[0]];function z(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a):e.attachEvent&&e.attachEvent("on".concat(t),n)}function H(e,t,n,a){e.removeEventListener?e.removeEventListener(t,n,a):e.attachEvent&&e.detachEvent("on".concat(t),n)}var $=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},K=!("undefined"!=typeof window&&window.document&&window.document.createElement),q=function e(t,n,a,o){if(!n||n===document||n instanceof Document)return!1;if(n===t.parentNode)return!0;var l=Math.max(Math.abs(a),Math.abs(o))===Math.abs(o),r=Math.max(Math.abs(a),Math.abs(o))===Math.abs(a),i=n.scrollHeight-n.clientHeight,s=n.scrollWidth-n.clientWidth,c=document.defaultView.getComputedStyle(n),u="auto"===c.overflowY||"scroll"===c.overflowY,d="auto"===c.overflowX||"scroll"===c.overflowX,v=i&&u,f=s&&d;return!!(l&&(!v||v&&(n.scrollTop>=i&&o<0||n.scrollTop<=0&&o>0))||r&&(!f||f&&(n.scrollLeft>=s&&a<0||n.scrollLeft<=0&&a>0)))&&e(t,n.parentNode,a,o)},Z=globalThis&&globalThis.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},G={},J=p({inheritAttrs:!1,props:e(e({},D()),{getContainer:Function,getOpenCount:Function,scrollLocker:t.any,switchScrollingEffect:Function}),emits:["close","handleClick","change"],setup:function(t,r){var i,s=r.emit,c=r.slots,u=h({startPos:{x:null,y:null}}),d=y(),v=y(),f=y(),p=y(),x=y(),E=[],O="drawer_id_".concat(Number((Date.now()+Math.random()).toString().replace(".",Math.round(9*Math.random()).toString())).toString(16)),S=!(K||!Y)&&{passive:!1};m((function(){g((function(){var e,n=t.open,a=t.getContainer,o=t.showMask,l=t.autofocus,r=null==a?void 0:a();Q(t),n&&(r&&r.parentNode===document.body&&(G[O]=n),V(),g((function(){l&&L()})),o&&(null===(e=t.scrollLocker)||void 0===e||e.lock()))}))})),b((function(){return t.level}),(function(){Q(t)}),{flush:"post"}),b((function(){return t.open}),(function(){var e=t.open,n=t.getContainer,a=t.scrollLocker,o=t.showMask,l=t.autofocus,r=null==n?void 0:n();r&&r.parentNode===document.body&&(G[O]=!!e),V(),e?(l&&L(),o&&(null==a||a.lock())):null==a||a.unLock()}),{flush:"post"}),w((function(){var e,n=t.open;delete G[O],n&&(I(!1),document.body.style.touchAction=""),null===(e=t.scrollLocker)||void 0===e||e.unLock()})),b((function(){return t.placement}),(function(e){e&&(x.value=null)}));var L=function(){var e,t;null===(t=null===(e=v.value)||void 0===e?void 0:e.focus)||void 0===t||t.call(e)},j=function(e){e.touches.length>1||(u.startPos={x:e.touches[0].clientX,y:e.touches[0].clientY})},T=function(e){if(!(e.changedTouches.length>1)){var t=e.currentTarget,n=e.changedTouches[0].clientX-u.startPos.x,a=e.changedTouches[0].clientY-u.startPos.y;(t===f.value||t===p.value||t===x.value&&q(t,e.target,n,a))&&e.cancelable&&e.preventDefault()}},N=function e(t){var n=t.target;H(n,W,e),n.style.transition=""},B=function(e){s("close",e)},M=function(e){e.keyCode===U.ESC&&(e.stopPropagation(),B(e))},P=function(e){var n=t.open,a=t.afterVisibleChange;e.target===d.value&&e.propertyName.match(/transform$/)&&(v.value.style.transition="",!n&&J()&&(document.body.style.overflowX="",f.value&&(f.value.style.left="",f.value.style.width="")),a&&a(!!n))},R=C((function(){var e=t.placement,n="left"===e||"right"===e;return{isHorizontal:n,placementName:"translate".concat(n?"X":"Y")}})),V=function(){var e=t.open,n=t.width,a=t.height,o=R.value,l=o.isHorizontal,r=o.placementName,i=x.value?x.value.getBoundingClientRect()[l?"width":"height"]:0;_(e,r,(l?n:a)||i)},I=function(e,n,a,o){var l=t.placement,r=t.levelMove,i=t.duration,s=t.ease,c=t.showMask;E.forEach((function(t){t.style.transition="transform ".concat(i," ").concat(s),z(t,W,N);var u,d,v,f=e?a:0;if(r){var p=(d={target:t,open:e},v="function"==typeof(u=r)?u(d):u,Array.isArray(v)?2===v.length?v:[v[0],v[1]]:[v]);f=e?p[0]:p[1]||0}var h="number"==typeof f?"".concat(f,"px"):f,y="left"===l||"top"===l?h:"-".concat(h);y=c&&"right"===l&&o?"calc(".concat(y," + ").concat(o,"px)"):y,t.style.transform=f?"".concat(n,"(").concat(y,")"):""}))},_=function(e,t,n){if(!K){var a=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth?A(!0):0;I(e,t,n,a),X(a)}s("change",e)},X=function(e){var n=t.getContainer,a=t.showMask,o=t.open,l=null==n?void 0:n();if(l&&l.parentNode===document.body&&a){var r=["touchstart"],i=[document.body,f.value,p.value,x.value];o&&"hidden"!==document.body.style.overflow?(e&&D(e),document.body.style.touchAction="none",i.forEach((function(e,t){e&&z(e,r[t]||"touchmove",t?T:j,S)}))):J()&&(document.body.style.touchAction="",e&&F(e),i.forEach((function(e,t){e&&H(e,r[t]||"touchmove",t?T:j,S)})))}},D=function(e){var n=t.placement,a=t.duration,o=t.ease,l="width ".concat(a," ").concat(o),r="transform ".concat(a," ").concat(o);switch(v.value.style.transition="none",n){case"right":v.value.style.transform="translateX(-".concat(e,"px)");break;case"top":case"bottom":v.value.style.width="calc(100% - ".concat(e,"px)"),v.value.style.transform="translateZ(0)"}clearTimeout(i),i=setTimeout((function(){v.value&&(v.value.style.transition="".concat(r,",").concat(l),v.value.style.width="",v.value.style.transform="")}))},F=function(e){var n,a=t.placement,o=t.duration,l=t.ease;v.value.style.transition="none";var r="width ".concat(o," ").concat(l),s="transform ".concat(o," ").concat(l);switch(a){case"left":v.value.style.width="100%",r="width 0s ".concat(l," ").concat(o);break;case"right":v.value.style.transform="translateX(".concat(e,"px)"),v.value.style.width="100%",r="width 0s ".concat(l," ").concat(o),f.value&&(f.value.style.left="-".concat(e,"px"),f.value.style.width="calc(100% + ".concat(e,"px)"));break;case"top":case"bottom":v.value.style.width="calc(100% + ".concat(e,"px)"),v.value.style.height="100%",v.value.style.transform="translateZ(0)",n="height 0s ".concat(l," ").concat(o)}clearTimeout(i),i=setTimeout((function(){v.value&&(v.value.style.transition="".concat(s,",").concat(n?"".concat(n,","):"").concat(r),v.value.style.transform="",v.value.style.width="",v.value.style.height="")}))},J=function(){return!Object.keys(G).some((function(e){return G[e]}))},Q=function(e){var t=e.level,n=e.getContainer;if(!K){var a,o=null==n?void 0:n(),l=o?o.parentNode:null;if(E=[],"all"===t)(l?Array.prototype.slice.call(l.children):[]).forEach((function(e){"SCRIPT"!==e.nodeName&&"STYLE"!==e.nodeName&&"LINK"!==e.nodeName&&e!==o&&E.push(e)}));else t&&(a=t,Array.isArray(a)?a:[a]).forEach((function(e){document.querySelectorAll(e).forEach((function(e){E.push(e)}))}))}},ee=function(e){s("handleClick",e)},te=y(!1);return b(v,(function(){g((function(){te.value=!0}))})),function(){var r,i,s,u=t.width,h=t.height,y=t.open,m=t.prefixCls,g=t.placement;t.level,t.levelMove,t.ease,t.duration,t.getContainer,t.onChange,t.afterVisibleChange;var b=t.showMask,w=t.maskClosable,C=t.maskStyle,E=t.keyboard;t.getOpenCount,t.scrollLocker;var O=t.contentWrapperStyle,S=t.style,L=t.class,j=Z(t,["width","height","open","prefixCls","placement","level","levelMove","ease","duration","getContainer","onChange","afterVisibleChange","showMask","maskClosable","maskStyle","keyboard","getOpenCount","scrollLocker","contentWrapperStyle","style","class"]),T=y&&te.value,N=n(m,(a(r={},"".concat(m,"-").concat(g),!0),a(r,"".concat(m,"-open"),T),a(r,L,!!L),a(r,"no-mask",!b),r)),V=R.value.placementName,I="left"===g||"top"===g?"-100%":"100%",_=T?"":"".concat(V,"(").concat(I,")");return k("div",o(o({},l(j,["switchScrollingEffect","autofocus"])),{},{tabindex:-1,class:N,style:S,ref:v,onKeydown:T&&E?M:void 0,onTransitionend:P}),[b&&k("div",{class:"".concat(m,"-mask"),onClick:w?B:void 0,style:C,ref:f},null),k("div",{class:"".concat(m,"-content-wrapper"),style:e({transform:_,msTransform:_,width:$(u)?"".concat(u,"px"):u,height:$(h)?"".concat(h,"px"):h},O),ref:d},[k("div",{class:"".concat(m,"-content"),ref:x},[null===(i=c.default)||void 0===i?void 0:i.call(c)]),c.handler?k("div",{onClick:ee,ref:p},[null===(s=c.handler)||void 0===s?void 0:s.call(c)]):null])])}}}),Q=globalThis&&globalThis.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},ee=p({inheritAttrs:!1,props:r(e(e({},D()),{forceRender:{type:Boolean,default:void 0},getContainer:t.oneOfType([t.string,t.func,t.object,t.looseBool])}),{prefixCls:"drawer",placement:"left",getContainer:"body",level:"all",duration:".3s",ease:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",afterVisibleChange:function(){},showMask:!0,maskClosable:!0,maskStyle:{},wrapperClassName:"",keyboard:!0,forceRender:!1,autofocus:!0}),emits:["handleClick","close"],slots:["handler"],setup:function(e,t){var n=t.emit,a=t.slots,l=y(null),r=function(e){n("handleClick",e)},i=function(e){n("close",e)};return function(){e.afterVisibleChange;var t=e.getContainer,n=e.wrapperClassName,s=e.forceRender,c=Q(e,["afterVisibleChange","getContainer","wrapperClassName","forceRender"]),u=null;if(!t)return k("div",{class:n,ref:l},[k(J,o(o({},c),{},{open:e.open,getContainer:function(){return l.value},onClose:i,onHandleClick:r}),a)]);var d=!!a.handler||s;return(d||e.open||l.value)&&(u=k(X,{visible:e.open,forceRender:d,getContainer:t,wrapperClassName:n},{default:function(t){var n=t.visible,s=t.afterClose,u=Q(t,["visible","afterClose"]);return k(J,o(o(o({ref:l},c),u),{},{open:void 0!==n?n:e.open,afterVisibleChange:void 0!==s?s:e.afterVisibleChange,onClose:i,onHandleClick:r}),a)}})),u}}}),te=globalThis&&globalThis.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},ne=s("top","right","bottom","left");s("default","large");var ae={distance:180},oe=i(p({name:"ADrawer",inheritAttrs:!1,props:r({autofocus:{type:Boolean,default:void 0},closable:{type:Boolean,default:void 0},closeIcon:t.any,destroyOnClose:{type:Boolean,default:void 0},forceRender:{type:Boolean,default:void 0},getContainer:t.any,maskClosable:{type:Boolean,default:void 0},mask:{type:Boolean,default:void 0},maskStyle:{type:Object,default:void 0},wrapStyle:{type:Object,default:void 0},style:{type:Object,default:void 0},class:t.any,wrapClassName:String,size:{type:String},drawerStyle:{type:Object,default:void 0},headerStyle:{type:Object,default:void 0},bodyStyle:{type:Object,default:void 0},contentWrapperStyle:{type:Object,default:void 0},title:t.any,visible:{type:Boolean,default:void 0},width:t.oneOfType([t.string,t.number]),height:t.oneOfType([t.string,t.number]),zIndex:Number,prefixCls:String,push:t.oneOfType([t.looseBool,{type:Object}]),placement:t.oneOf(ne),keyboard:{type:Boolean,default:void 0},extra:t.any,footer:t.any,footerStyle:{type:Object,default:void 0},level:t.any,levelMove:{type:[Number,Array,Function]},handle:t.any,afterVisibleChange:Function,onAfterVisibleChange:Function,"onUpdate:visible":Function,onClose:Function},{closable:!0,placement:"right",maskClosable:!0,mask:!0,level:null,keyboard:!0,push:ae}),slots:["closeIcon","title","extra","footer","handle"],setup:function(t,o){var r=o.emit,i=o.slots,s=o.attrs,f=y(!1),p=y(!1),h=y(null),O=x("parentDrawerOpts",null),S=c("drawer",t).prefixCls;u(!t.afterVisibleChange,"Drawer","`afterVisibleChange` prop is deprecated, please use `@afterVisibleChange` event instead"),u(void 0===t.wrapStyle,"Drawer","`wrapStyle` prop is deprecated, please use `style` instead"),u(void 0===t.wrapClassName,"Drawer","`wrapClassName` prop is deprecated, please use `class` instead");E("parentDrawerOpts",{setPush:function(){f.value=!0},setPull:function(){f.value=!1,g((function(){L()}))}}),m((function(){t.visible&&O&&O.setPush()})),w((function(){O&&O.setPull()})),b((function(){return t.visible}),(function(e){O&&(e?O.setPush():O.setPull())}),{flush:"post"});var L=function(){var e,t;null===(t=null===(e=h.value)||void 0===e?void 0:e.domFocus)||void 0===t||t.call(e)},j=function(e){r("update:visible",!1),r("close",e)},T=function(e){var n;null===(n=t.afterVisibleChange)||void 0===n||n.call(t,e),r("afterVisibleChange",e)},N=C((function(){return t.destroyOnClose&&!t.visible})),B=function(){N.value&&(t.visible||(p.value=!0))},M=C((function(){var e,n=t.push,a=t.placement;return e="boolean"==typeof n?n?ae.distance:0:n.distance,e=parseFloat(String(e||0)),"left"===a||"right"===a?"translateX(".concat("left"===a?e:-e,"px)"):"top"===a||"bottom"===a?"translateY(".concat("top"===a?e:-e,"px)"):null})),P=C((function(){var e=t.visible,n=t.mask,a=t.placement,o=t.size,l=void 0===o?"default":o,r=t.width,i=t.height;if(!e&&!n)return{};var s={};if("left"===a||"right"===a){var c="large"===l?736:378;s.width=void 0===r?c:r,s.width="string"==typeof s.width?s.width:"".concat(s.width,"px")}else{var u="large"===l?736:378;s.height=void 0===i?u:i,s.height="string"==typeof s.height?s.height:"".concat(s.height,"px")}return s})),R=C((function(){var n=t.zIndex,a=t.wrapStyle,o=t.mask,l=t.style,r=o?{}:P.value;return e(e(e({zIndex:n,transform:f.value?M.value:void 0},r),a),l)})),V=function(e){var o=t.closable,l=t.headerStyle,r=d(i,t,"extra"),s=d(i,t,"title");return s||o?k("div",{class:n("".concat(e,"-header"),a({},"".concat(e,"-header-close-only"),o&&!s&&!r)),style:l},[k("div",{class:"".concat(e,"-header-title")},[I(e),s&&k("div",{class:"".concat(e,"-title")},[s])]),r&&k("div",{class:"".concat(e,"-extra")},[r])]):null},I=function(e){var n,a=t.closable,o=i.closeIcon?null===(n=i.closeIcon)||void 0===n?void 0:n.call(i):t.closeIcon;return a&&k("button",{key:"closer",onClick:j,"aria-label":"Close",class:"".concat(e,"-close")},[void 0===o?k(v,null,null):o])},_=function(e){var n=d(i,t,"footer");if(!n)return null;var a="".concat(e,"-footer");return k("div",{class:a,style:t.footerStyle},[n])};return function(){var o;t.width,t.height;var r=t.visible,c=t.placement,u=t.mask,d=t.wrapClassName,v=t.class,f=te(t,["width","height","visible","placement","mask","wrapClassName","class"]),y=u?P.value:{},m=u?"":"no-mask",g=e(e(e(e({},s),l(f,["size","closeIcon","closable","destroyOnClose","drawerStyle","headerStyle","bodyStyle","title","push","wrapStyle","onAfterVisibleChange","onClose","onUpdate:visible"])),y),{onClose:j,afterVisibleChange:T,handler:!1,prefixCls:S.value,open:r,showMask:u,placement:c,class:n((o={},a(o,v,v),a(o,d,!!d),a(o,m,!!m),o)),style:R.value,ref:h});return k(ee,g,{handler:t.handle?function(){return t.handle}:i.handle,default:function(){return function(n){var a;if(p.value&&!t.visible)return null;p.value=!1;var o=t.bodyStyle,l=t.drawerStyle,r={};return N.value&&(r.opacity=0,r.transition="opacity .3s"),k("div",{class:"".concat(n,"-wrapper-body"),style:e(e({},r),l),onTransitionend:B},[V(n),k("div",{key:"body",class:"".concat(n,"-body"),style:o},[null===(a=i.default)||void 0===a?void 0:a.call(i)]),_(n)])}(S.value)}})}}}));const le=(e,t,n,a=!0)=>{const o="ontouchstart"in document.documentElement,l=e.getContext("2d");function r(e,t,n,a){l&&(l.beginPath(),l.moveTo(e,t),l.lineTo(n,a),l.stroke())}l&&(l.fillStyle=t,l.strokeStyle=t,l.lineWidth=n,l.lineCap="round");let i,s=!1;function c(e){s=!0;const t=e.touches[0].pageX,n=e.touches[0].pageY;i=[t,n]}function u(e){s=!0;const t=e.touches[0].pageX,n=e.touches[0].pageY;r(i[0],i[1],t,n),i=[t,n]}function d(){s=!1}function v(e){s=!0,i=[e.offsetX,e.offsetY]}function f(e){s&&(r(i[0],i[1],e.offsetX,e.offsetY),i=[e.offsetX,e.offsetY])}document.getElementById("clear").addEventListener("click",(()=>{o?(e.removeEventListener("touchstart",c,!1),e.removeEventListener("touchmove",u,!1),e.removeEventListener("touchend",d,!1)):(e.removeEventListener("mousedown",v),e.removeEventListener("mousemove",f),e.removeEventListener("mouseup",d))})),o&&a?(e.addEventListener("touchstart",c,!1),e.addEventListener("touchmove",u,!1),e.addEventListener("touchend",d,!1)):!o&&a&&(e.addEventListener("mousedown",v),e.addEventListener("mousemove",f),e.addEventListener("mouseup",d))},re=(e,t,n,a,o)=>new Promise(((l,r)=>{const i=e.toDataURL(n||"image/png",t||1),s=new Image;s.src=i;const c=document.createElement("canvas"),u=c.getContext("2d");c.width=document.body.getBoundingClientRect().width,c.height=o,u.fillStyle=a||"white",u.fillRect(0,0,document.body.getBoundingClientRect().width,o),s.onload=()=>{u.drawImage(s,0,0,document.body.getBoundingClientRect().width,o),l(c.toDataURL(n||"image/png",t||1))},s.onerror=e=>{r(e)}})),ie=(e,t,n)=>new Promise(((a,o)=>{const l=e.toDataURL(n||"image",t||1),r=new Image;r.src=l,r.onload=()=>{a(r)},r.onerror=e=>{o(e)}})),se=e=>{const t=e.split(","),n=t[0].match(/:(.*?);/)[1],a=atob(t[1]);let o=a.length;const l=new Uint8Array(o);for(;o--;)l[o]=a.charCodeAt(o);return new Blob([l],{type:n})};const ce=e=>(I("data-v-394fe81b"),e=e(),_(),e),ue={class:"wrap"},de={id:"canvasWrap"},ve={class:"selector"},fe=V("画板设置"),pe=V("清空画布内容"),he=V("橡皮擦"),ye=V("继续绘画"),me=V("导出为文件"),ge={class:"setting"},be={class:"section"},we=ce((()=>j("svg",{class:"icon","aria-hidden":"true"},[j("use",{"xlink:href":"#icon-beijingyanse"})],-1))),Ce={class:"section"},ke={class:"section"},xe=ce((()=>j("svg",{class:"icon","aria-hidden":"true"},[j("use",{"xlink:href":"#icon-beijingyanse"})],-1))),Ee={class:"section changeHeight"},Oe={class:"section"};var Se=O(p({__name:"Canvas",setup(e){const t=y(),n=y("#000000"),a=y(4),o=y("#ffffff"),l=y(parseInt(document.body.getBoundingClientRect().height.toString(),10)),r=()=>{le(t.value,n.value,a.value)};m((()=>{t.value.width=document.body.getBoundingClientRect().width,t.value.height=document.body.getBoundingClientRect().height,le(t.value,n.value,a.value)}));const i=y(!1),s=()=>{i.value=!0},c=async()=>{const e=await(async()=>{let e;try{e=await ie(t.value,1,"image")}catch(n){}return e})();t.value.width=document.body.getBoundingClientRect().width,t.value.height=l.value;t.value.getContext("2d").drawImage(e,0,0),r(),i.value=!1},u=()=>{const e=t.value.getContext("2d");e&&(e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.value.width,t.value.height),e.restore())},d=y();function v(e){const t=e.touches[0].pageX,n=e.touches[0].pageY;d.value.style.top=`${n}px`,d.value.style.left=`${t}px`}function p(e){d.value.style.display="block";const n=e.touches[0].pageX,a=e.touches[0].pageY;d.value.style.top=`${a}px`,d.value.style.left=`${n}px`;t.value.getContext("2d").clearRect(n,a,b.value,b.value)}function h(){d.value.style.display="none",t.value.removeEventListener("touchstart",v),t.value.removeEventListener("touchmove",p),t.value.removeEventListener("touchend",h)}const g=y(!1),b=y(20);function w(e){g.value=!0;const t=e.offsetX,n=e.offsetY;d.value.style.top=`${n}px`,d.value.style.left=`${t}px`}function C(e){if(g.value){const n=e.offsetX,a=e.offsetY;d.value.style.display="block",d.value.style.top=`${a}px`,d.value.style.left=`${n}px`;t.value.getContext("2d").clearRect(n,a,b.value,b.value)}}function x(){g.value=!1,d.value.style.display="none",t.value.removeEventListener("mousedown",w),t.value.removeEventListener("mousemove",C),document.documentElement.removeEventListener("mouseup",x)}const E=()=>{le(t.value,n.value,a.value)},O=()=>{le(t.value,"transparent",1,!1);"ontouchstart"in document.documentElement?(t.value.addEventListener("touchstart",v),t.value.addEventListener("touchmove",p),t.value.addEventListener("touchend",h)):(t.value.addEventListener("mousedown",w),t.value.addEventListener("mousemove",C),document.documentElement.addEventListener("mouseup",x))},V=async()=>{const e=`${Math.floor(1e4*Math.random())}.png`,n=await re(t.value,1,"image/png",o.value,l.value),a=se(n);if("download"in document.createElement("a")){const t=document.createElement("a");t.download=e,t.style.display="none",t.href=URL.createObjectURL(a),document.body.appendChild(t),t.click(),URL.revokeObjectURL(t.href),document.body.removeChild(t)}};return(e,v)=>{const p=f,h=oe;return S(),L("div",ue,[j("div",de,[j("canvas",{ref_key:"canvasEl",ref:t,style:T({background:o.value}),class:"canvasEl"},null,4),j("div",ve,[k(p,{type:"primary",onClick:s},{default:N((()=>[fe])),_:1}),k(p,{type:"primary",onClick:u},{default:N((()=>[pe])),_:1}),k(p,{type:"primary",id:"clear",onClick:B(O,["prevent"])},{default:N((()=>[he])),_:1},8,["onClick"]),k(p,{type:"primary",onClick:E},{default:N((()=>[ye])),_:1}),k(p,{type:"primary",onClick:V},{default:N((()=>[me])),_:1})])]),k(h,{visible:i.value,"onUpdate:visible":v[5]||(v[5]=e=>i.value=e),class:"custom-class",width:"30%",closable:!1,title:"画板设置",placement:"right"},{default:N((()=>[j("div",ge,[j("div",be,[j("p",null,"线条颜色:"+M(n.value),1),j("label",null,[we,P(j("input",{type:"color","onUpdate:modelValue":v[0]||(v[0]=e=>n.value=e),onChange:r},null,544),[[R,n.value]])])]),j("div",Ce,[j("p",null,"线条宽度:"+M(a.value),1),j("label",null,[P(j("input",{type:"text","onUpdate:modelValue":v[1]||(v[1]=e=>a.value=e),onChange:r,style:{"max-width":"50px"}},null,544),[[R,a.value,void 0,{number:!0}]])])]),j("div",ke,[j("p",null,"画布颜色:"+M(o.value),1),j("label",null,[xe,P(j("input",{type:"color","onUpdate:modelValue":v[2]||(v[2]=e=>o.value=e),onChange:r},null,544),[[R,o.value]])])]),j("div",Ee,[j("p",null,"画布高度:"+M(l.value),1),j("label",null,[P(j("input",{type:"text","onUpdate:modelValue":v[3]||(v[3]=e=>l.value=e),style:{"max-width":"50px"},onChange:c},null,544),[[R,l.value,void 0,{number:!0}]])])]),j("div",Oe,[j("p",null,"橡皮擦宽度:"+M(b.value),1),j("label",null,[P(j("input",{type:"text","onUpdate:modelValue":v[4]||(v[4]=e=>b.value=e),style:{"max-width":"50px"}},null,512),[[R,b.value,void 0,{number:!0}]])])])])])),_:1},8,["visible"]),j("div",{ref_key:"clearTag",ref:d,id:"clearTag"},null,512)])}}}),[["__scopeId","data-v-394fe81b"]]);export{Se as default};
